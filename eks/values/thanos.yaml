commonLabels:
  cluster: monitoring
  region: us-east-1
serviceAccount:
  name: thanos-role
objstoreConfig: |-
  type: s3
  config:
    bucket: dev-demo-thanos-metrics-prometheus
    endpoint: s3.us-east-1.amazonaws.com
    sse_config:
      type: "SSE-S3"
query:
  enabled: true
  extraFlags:
    - --grpc-client-tls-skip-verify
  stores:
  # Stores, they point to observee sidecard endpoints
    - storegateway-thanos.aws.aurotfp.com:443
    - thanos-sidecar-prometheus.aws.aurotfp.com:443
    - ruler-thanos.aws.aurotfp.com:443
    - thanos-infra-tools.aws.aurotfp.com:443
  
  # dnsDiscovery points to the location of the internal thanos sidecar and namespace
  dnsDiscovery:
    enabled: false
    sidecarsService: kube-prometheus-stack-thanos-discovery
    sidecarsNamespace: monitoring
  grpc:
    client:
      tls:
        enabled: true
        autoGenerated: true
    server:
      tls:
        enabled: true
        autoGenerated: true

queryFrontend:
  ingress:
    enabled: true
    hostname: query-thanos.aws.aurotfp.com
    pathType: Prefix
    annotations:
      kubernetes.io/ingress.class: alb
      external-dns/zone: private
      external-dns.alpha.kubernetes.io/hostname: query-thanos.aws.aurotfp.com
      alb.ingress.kubernetes.io/scheme: internal
      alb.ingress.kubernetes.io/subnets: subnet-0bff897d94caea79c, subnet-0d805eacd24f662d1
      alb.ingress.kubernetes.io/listen-ports: '[{"HTTPS": 443}]'
      alb.ingress.kubernetes.io/target-type: ip
      alb.ingress.kubernetes.io/success-codes: 200-302
      alb.ingress.kubernetes.io/actions.ssl-redirect: '{"Type": "redirect", "RedirectConfig": { "Protocol": "HTTPS", "Port": "443", "StatusCode": "HTTP_301"}}'
      alb.ingress.kubernetes.io/certificate-arn: arn:aws:acm:us-east-1:770688751007:certificate/a04e263f-8c9d-4e1f-a3ca-8bf79fbcf5e6
    
bucketweb:
  enabled: true
compactor:
  enabled: true
  serviceAccount:
    name: thanos-role
    create: false
storegateway:
  enabled: true
  serviceAccount:
    name: thanos-role
    create: false
ruler:
  enabled: true
  extraFlags:
    - --label=cluster="monitoring"
    - --label=region="us-east-1"
  serviceAccount:
    name: thanos-role
    create: false
  alertmanagers:
    - http://kube-prometheus-alertmanager.monitoring.svc.cluster.local:9093
  config: |-
    groups:
      - name: "metamonitoring"
        rules:
          - alert: "PrometheusDown"
            expr: absent(up{prometheus="monitoring/kube-prometheus"})
metrics:
  enabled: true
  serviceMonitor:
    enabled: true
